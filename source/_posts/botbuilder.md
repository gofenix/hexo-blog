---
title: 谈谈聊天机器人框架的实现原理
date: 2018-08-22 19:39:12
tags:
---

在这篇文章不考虑人工智能，谈谈我对聊天机器人框架实现机制的理解。

## 聊天机器人

> **聊天机器人**（Chatterbot）是经由对话或文字进行交谈的计算机程序[[1\]](https://zh.wikipedia.org/wiki/%E8%81%8A%E5%A4%A9%E6%A9%9F%E5%99%A8%E4%BA%BA#cite_note-target-1)。能够模拟人类对话，通过[图灵测试](https://zh.wikipedia.org/wiki/%E5%9B%BE%E7%81%B5%E6%B5%8B%E8%AF%95)。

我们可以看到现有的IM工具上已经有了很多机器人，其实聊天机器人不只是单纯的和用户进行聊天，他其实还可以做很多事情，例如根据用户输入的一些话，可以帮用户订餐。另外在运维领域，也出现了chatops，通过和机器人聊天，进行运维操作。

## 机器人开发框架

作为聊天机器人开发者，面对如此多的IM工具和SDK，常会感到无所适从。Bot 开发框架就是对聊天机器人开发过程中的人工内容做抽象化处理。简单地解释，机器人开发框架就是用来制造机器人并定义其行为。

然而尽管很多机器人框架宣称「代码一旦写好可部署到任何地方」，但是还会是出现为每一个IM工具开发一个单独的聊天机器人。而一个良好的机器人框架主要包含开发SDK，连接器和模拟器等。

使用机器人框架其实并不适合初学者学习聊天机器人开发。它们尝试自动化太多工作，对初学者掩盖了基础机制。

## 实现方式

- webhook事件回调
- FSM状态机
- workflow工作流

最简单的机器人是没有上下文的语义理解的一问一答，仅仅是对用户的对话进行响应，这种就可以采用webhook的方式进行开发。不需要采用什么开发框架。

那么对于多轮对话的时候，就需要进行一定的对话管理。由此引入了FSM状态机。

可能有人不是很懂有限状态机，这里做一下简单说明。

> 有限状态机在现实生活中其实随处可见，伸缩式圆珠笔其实就是一个有限状态机（两种状态互相转换）。
>
> 有限状态机，缩写为FSM，又称为有限状态自动机，简称状态机。是表示有限个[状态](https://zh.wikipedia.org/wiki/%E7%8A%B6%E6%80%81)以及在这些状态之间的转移和动作等行为的[数学模型](https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B)。 
>
> 可以总结为：f(state, action) => state’
>
> 也就是说，这个函数采用当前的状态和一次行动（即更改状态的方法），之后将该行动应用于这种状态并返回新的状态。
>
> 可以认为状态机是图灵完备的。

我们可以将对话看做是在有限状态内跳转的过程，每个状态都有对应的动作和回复，如果能从开始节点顺利的流转到终止节点，任务就完成了。

我们可以将对话的过程，分为一个个的状态，然后使用DSL来实现一个FSM，对于开发者来讲，我们只需要关注一个个状态函数即可。

特点是：

- 人为定义对话流程
- 完全有系统主导，系统问用户答
- 答非所问的情况直接忽略
- 建模简单，能清晰明了的把交互匹配到模型
- 难以扩展，很容易变的复杂
- 适用于简单的任务，难以处理复杂问题
- 缺少灵活性，表达能力有限，输入有限，对话结构和流转路径有限

示例：



主要记录一下对微软项目的机器人框架的梳理。

现阶段聊天机器人主要